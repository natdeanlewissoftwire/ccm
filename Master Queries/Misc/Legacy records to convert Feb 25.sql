SELECT sf_customers.customer_name AS 'Account Name', sf_customers.customer_party_unique_reference_number AS 'Party URN', sf_customers.customer_duns_number AS 'D&B Number', customer_address_country AS 'Trading Country',
CASE
WHEN customer_address_country IS NULL THEN NULL
WHEN customer_address_country = 'UNITED KINGDOM' THEN 'National'
ELSE 'International'
END
AS 'National/International',
-- NULL AS 'Party Validated',
sf_customers.ods_key AS 'LDP ID'
FROM (
SELECT DISTINCT 
    -- customer.source,
    -- customer.customer_code,
    -- customer.customer_name,
    customer.customer_party_unique_reference_number,
    -- customer.customer_duns_number,
    customer_address_country
    -- customer_address_postcode
FROM [ODS].[dbo].[customer] customer
    JOIN [ODS].[dbo].[facility_party] facility_party
    ON customer.source = facility_party.source
        AND customer.ods_key = facility_party.customer_ods_key
    JOIN [ODS].[dbo].[facility] facility
    ON facility_party.source = facility.source
        AND facility_party.facility_ods_key = facility.ods_key
    LEFT JOIN customer_address
        ON customer_address.customer_ods_key = customer.ods_key
        AND customer_address.source = customer.source
WHERE customer.source = 'ACBS'
    -- AND facility.facility_status_description = 'ACTIVE ACCOUNT'
    -- --  exclude UKEF records
    -- AND customer.customer_code != '00000000'
    -- --  exclude deleted records
    -- AND customer.change_type != 'D'
    -- AND facility_party.change_type != 'D'
    -- AND facility.change_type != 'D'
) AS acbs_customers
RIGHT JOIN customer sf_customers
ON sf_customers.customer_party_unique_reference_number = acbs_customers.customer_party_unique_reference_number
WHERE sf_customers.source = 'SalesforceLegacy'
AND sf_customers.customer_party_unique_reference_number IN
('00302063', '00301805', '00303207', '00300460', '00303451', '00301735', '00302255', '00314609', '00308519', '00312061', '00316892', '00314285', '00306796', '00311757', '00302882', '00302761', '00302238', '00309136', '00301786', '00301619', '00305594', '00302211', '00303140', '00301751', '00301523', '00301469', '00301868', '00300535', '00308842', '00308296', '00301742', '00301606', '00308865', '00304195', '00301246', '00301479', '00302168', '00300746', '00306964', '00301862', '00308699', '00302247', '00300505', '00302398', '00302806', '00303797', '00302441', '00313794', '00308729', '00300377', '00307275', '00301746', '00302311', '00302243', '00300231', '00304115', '00302576', '00303046', '00302591', '00300419', '00301998', '00308711', '00303644', '00301613', '00303079', '00304128', '00309197', '00301612', '00300452', '00304397', '00306637', '00300151', '00308938', '00310308', '00302554', '00304143', '00301114', '00302295', '00300609', '00302253', '00303858', '00312046', '00302289', '00301620', '00304609', '00301813', '00309047', '00300245', '00300883', '00301776', '00300346', '00300462', '00308958', '00301911', '00300415', '00304626', '00301503', '00302221', '00314122', '00301498', '00300825', '00302976', '00303500', '00302325', '00300149', '00307824', '00303973', '00302326', '00301894', '00306981', '00303848', '00300699', '00309032', '00302385', '00301468', '00300170', '00301902', '00309022', '00302001', '00302452', '00301476', '00308092', '00309224', '00300099', '00314661', '00303957', '00310287', '00307355', '00302213', '00309040', '00302180', '00301141', '00308964', '00301433', '00310832', '00303706', '00300209', '00300567', '00301895', '00306703', '00309004', '00305359', '00300223', '00308622', '00300568', '00301456', '00302279', '00306893', '00301605', '00302616', '00306745', '00301634', '00303873', '00307497', '00302322', '00304651', '00308589', '00308831', '00304796', '00302272', '00300258', '00301736', '00301153', '00304105', '00312100', '00300737', '00301724', '00302798', '00304107', '00309021', '00304042', '00304617', '00300329', '00301835', '00313259', '00300753', '00301144', '00300357', '00300757', '00302403', '00303908', '00300761', '00306742', '00304563', '00300196', '00307387', '00304196', '00304176', '00300870', '00302227', '00303259', '00302622', '00309172', '00300793', '00301554', '00306607', '00307381', '00301556', '00306689', '00301119', '00304081', '00304544', '00306771', '00313805', '00302443', '00306646', '00307051', '00300351', '00302099', '00303381', '00302008', '00302446', '00307082', '00302025', '00303173', '00303894', '00301489', '00301649', '00304821', '00301655', '00306540', '00302250', '00304168', '00301596', '00303864', '00301779', '00308946', '00303699', '00301656', '00307643', '00301139', '00303031', '00311296', '00313273', '00300306', '00306554', '00301573', '00300491', '00301834', '00300321', '00304415', '00302960', '00301577', '00304419', '00308752', '00302524', '00302304', '00308953', '00304098', '00300169', '00303567', '00310236', '00304602', '00303984', '00301994', '00304405', '00301198', '00308778', '00301660', '00303181', '00301420', '00300453', '00303975', '00303418', '00301761', '00301689', '00305367', '00302539', '00304213', '00304072', '00301396', '00307146', '00308592', '00301099', '00300533', '00301497', '00301625', '00308970', '00303904', '00308587', '00304559', '00303026', '00306541', '00308574', '00301801', '00303221', '00301544', '00301543', '00311338', '00313705', '00303923', '00301956', '00300385', '00307184', '00300394', '00300588', '00301235', '00303753', '00301880', '00301683', '00307636', '00310139', '00309270', '00301871', '00302914', '00303887', '00302571', '00307326', '00307299', '00304062', '00303710', '00302244', '00301560', '00303364', '00307415', '00301667', '00307330', '00300493', '00300473', '00310602', '00300549', '00304662', '00302286', '00302154', '00303514', '00306783', '00310727', '00301711', '00308121', '00308575', '00308577', '00303716', '00300441', '00309161', '00302949', '00303999', '00303880', '00300024', '00301696', '00304551', '00301861', '00304644', '00307014', '00302177', '00310392', '00310425', '00303862', '00301668', '00308207', '00301990', '00300499', '00304545', '00303723', '00301697', '00307113', '00303932', '00302974', '00301819', '00307540', '00302167', '00308739', '00313488', '00300408', '00300866', '00300863', '00300456', '00308962', '00310039', '00303974', '00312973', '00303951', '00300431', '00302204', '00306117', '00300450', '00310829', '00302203', '00304162', '00303910', '00301969', '00303576', '00301702', '00301412', '00302201', '00302264', '00306672', '00302946', '00301169', '00303075', '00307389', '00307706', '00303924', '00304384', '00304538', '00301504', '00303126', '00304627', '00301089', '00302195', '00301558', '00313184', '00300101', '00300571', '00300352', '00310859', '00312920', '00312919', '00312926', '00314637', '00318198', '00312903', '00301595', '00304587', '00311729', '00302235', '00301536', '00305895', '00322335', '00300172', '00312342', '00311882', '00310285', '00318850', '00320371', '00313997', '00311867', '00308262', '00310892', '00300862', '00318131', '00312324', '00310079', '00306864', '00300123', '00302756', '00308021', '00308259', '00302163', '00308932', '00307542', '00306412', '00310527', '00300316', '00309072', '00317021', '00303228', '00306565', '00302220', '00311767', '00320017', '00302584', '00309442', '00317223', '00314402', '00308762', '00314247', '00302012', '00309975', '00300012', '00309462', '00300372', '00309993', '00308951', '00312922', '00308491', '00300854', '00309448', '00316893', '00300288', '00314165', '00301219', '00300363', '00306529', '00314646', '00314473', '00310500', '00312493', '00301662', '00312882', '00312563', '00312513', '00300578', '00301965', '00301678', '00302439', '00300755', '00307029', '00300690', '00302890', '00310010', '00309333', '00309294', '00301849', '00304854', '00308799', '00306725', '00314265', '00311378', '00321679', '00324654', '00312593', '00318331', '00321143', '00326678', '00315785', '00312925', '00310757', '00308702', '00312317', '00313663', '00314613')

-- AND acbs_customers.customer_party_unique_reference_number IS NOT NULL
--     AND EXISTS (
--     SELECT *
--     FROM [ODS].[dbo].[customer] sf_customers
--     WHERE sf_customers.source = 'SalesforceLegacy'
--         AND sf_customers.customer_party_unique_reference_number = acbs_customers.customer_party_unique_reference_number

-- )
--     AND NOT EXISTS (
--     SELECT *
--     FROM [ODS].[dbo].[customer] sf_customers
--     WHERE sf_customers.source = 'SalesForce'
--         AND sf_customers.customer_party_unique_reference_number = acbs_customers.customer_party_unique_reference_number
-- )

-- GROUP BY sf_customers.customer_party_unique_reference_number,
--         sf_customers.customer_name,
--         sf_customers.customer_duns_number,
--         acbs_customers.customer_address_country,
--         sf_customers.ods_key

-- ORDER BY sf_customers.customer_name